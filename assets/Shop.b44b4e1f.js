import{r as s,j as e,a as o,L as P,i as I,F as T}from"./index.985eeefc.js";import{a as C}from"./AxiosClient.dbd67430.js";import{I as N}from"./Input.c32e98e8.js";import{B as F}from"./Blocks.cf062f1c.js";import{c as w,r as D}from"./DisplayHelper.ddeb9bf2.js";import{b as U}from"./index.da2ece37.js";import{n as L}from"./MessageHelper.96dc1da2.js";import{u as V}from"./useDispatch.12c5d5a9.js";const q=20,H=[{value:"latest-arrival",label:"Latest Arrival"},{value:"high-low",label:"Price: High to Low"},{value:"low-high",label:"Price: Low to High"}],_=({data:l,onSelected:d})=>{const[t,i]=s.exports.useState(l[0].value),n=a=>{i(a),d(a)};return e("ul",{children:l==null?void 0:l.map(a=>o("li",{className:"flex items-center px-3 py-1",children:[e("input",{type:"radio",id:a.value,className:"bg-slate-100 border-slate-300 text-slate-900 focus:ring-slate-200",onChange:()=>n(a.value),checked:t===a.value}),e("label",{htmlFor:a.value,className:"ml-2 w-max cursor-pointer text-sm sm:text-md",onClick:()=>n(a.value),children:a.label})]},a.label))})},O=({id:l,slug:d,name:t,handleSelectedCategory:i})=>o("li",{className:"flex w-100 items-center gap-2.5 px-3 py-1",children:[e(N,{type:"checkbox",id:d,value:l,className:"bg-slate-100 border-slate-300 text-slate-900 focus:ring-slate-200",onChange:n=>i(n)}),e("label",{htmlFor:d,className:"w-max cursor-pointer text-sm sm:text-md",children:t})]}),z=({handleSelectedCategories:l})=>{const[d,t]=s.exports.useState([]),[i,n]=s.exports.useState([]),a=async()=>{try{const{data:c}=await C.get("/api/v1/category");t(c.response)}catch(c){const r=c.response.data.message;console.log(r)}},x=c=>{let r=[];c.target.checked?(r=i,r.push(Number(c.target.value)),n(r)):(r=i.filter(h=>h!==Number(c.target.value)),n(r)),l(r)};return s.exports.useEffect(()=>{a(),console.log("Categories main")},[]),o("div",{className:"mt-4",children:[e("h3",{className:"bg-[#212529] text-white py-1 px-2 text-sm font-semibold uppercase sm:py-2 sm:px-4 rounded-md",children:"Categories"}),e("ul",{children:d!=null&&d.map(c=>s.exports.createElement(O,{...c,key:c.id,handleSelectedCategory:x}))})]})},G=({initalMin:l,initalMax:d,min:t,max:i,step:n,priceCap:a,handlePriceRange:x})=>{const c=s.exports.useRef(),[r,h]=s.exports.useState(l),[u,v]=s.exports.useState(d),[b,f]=s.exports.useState(!1),g=p=>{u-r>=a&&u<=i?Number(p.target.value)<Number(u)&&h(Number(p.target.value)):Number(p.target.value)<r&&h(Number(p.target.value))},y=p=>{u-r>=a&&u<=i?Number(p.target.value)>Number(r)&&v(Number(p.target.value)):Number(p.target.value)>u&&v(Number(p.target.value))};return s.exports.useEffect(()=>{c.current.style.left=r/i*100+"%",c.current.style.right=n-u/i*n+"%"},[r,u]),s.exports.useEffect(()=>{b&&x([r,u]),f(!1)},[b]),o("div",{className:"mt-4",children:[e("h3",{className:"bg-[#212529] text-white my-1 py-1 px-2 text-sm font-semibold uppercase sm:my-1 sm:py-2 sm:px-4 rounded-md",children:"Price Range"}),o("div",{className:"mt-4",children:[e("div",{className:"slider relative h-1 rounded-md bg-gray-300",children:e("div",{className:"progress absolute h-1 bg-blue-500 rounded",ref:c})}),o("div",{className:"range-input relative",children:[e(N,{type:"range",value:r,onChange:g,onMouseUp:()=>f(!0),min:t,step:n,max:i,className:"range-min absolute w-full -top-1 h-1 bg-transparent appearance-none pointer-events-none cursor-grab active:cursor-grabbing"}),e(N,{type:"range",value:u,onChange:y,onMouseUp:()=>f(!0),min:t,step:n,max:i,className:"range-min absolute w-full -top-1 h-1 bg-transparent appearance-none pointer-events-none cursor-grab active:cursor-grabbing"})]})]}),o("div",{className:"flex justify-between text-center mt-4 w-full",children:[e(N,{type:"number",className:"bg-gray-100 border border-gray-300 text-gray-900 text-sm text-center rounded-lg focus:ring-blue-500 focus:border-blue-500 block cursor-not-allowed w-24",disabled:!0,value:r,placeholder:"Min Price"}),e(N,{type:"number",className:"bg-gray-100 border border-gray-300 text-gray-900 text-sm text-center rounded-lg focus:ring-blue-500 focus:border-blue-500 block cursor-not-allowed w-24",disabled:!0,value:u,placeholder:"Max Price"})]})]})},J=({id:l,name:d,slug:t,unit_price:i,actual_price:n,discount:a,productImages:x,other:c})=>{const r=V(),[h,u]=s.exports.useState(!1),v=async()=>{var b,f;try{u(!0);const{data:g}=await C.post("/api/v1/cart",{product_id:l,qty:1});r(I.setCart(g.response.data)),L("success",g.message)}catch(g){const y=(f=(b=g.response)==null?void 0:b.data)==null?void 0:f.message;console.log(y),g.response.status===401&&L("error","Please login first to add to cart.")}finally{u(!1)}};return o("div",{className:"flex flex-col",children:[o(P,{to:`/product/${t}`,className:"group",children:[e("div",{className:"w-full overflow-hidden rounded-md bg-gray-200 group-hover:opacity-75 lg:aspect-none lg:h-80",children:e(U.exports.LazyLoadImage,{src:x[0].url,alt:"alt image",className:"h-full w-full object-cover object-center aspect-square"})}),o("div",{className:"mt-2",children:[o("h3",{className:"text-sm text-gray-900",children:[e("span",{className:"absolute"}),d]}),o("div",{className:"flex justify-between gap-2 items-end",children:[e("p",{className:"mt-1 text-sm text-gray-900",children:w(n)}),a>0&&o("div",{className:"flex items-end gap-2",children:[e("p",{className:"text-xs text-gray-600 line-through",children:w(i)}),e("p",{className:"text-xs text-gray-900",children:`-${w(a,"",0)}%`})]})]})]})]}),e(F,{className:"px-3 py-2 text-center bg-[#212529] text-white hover:bg-[#424649] w-full rounded-md text-md md:text-md md:font-semibold mt-2 disabled:bg-[#999FA4] disabled:text-[#F5F5F5]",btnText:"Add to cart",loading:h,onClick:v})]})},K=({products:l})=>e("div",{className:"mt-4 grid grid-cols-2 gap-y-10 gap-x-6 sm:grid-cols-3 xl:grid-cols-4 xl:gap-x-8",children:l!=null&&l.map(d=>s.exports.createElement(J,{...d,key:d.slug}))}),Q=({onSelectedRadio:l})=>o("div",{className:"mt-4",children:[e("h3",{className:"bg-[#212529] text-white my-1 py-1 px-2 text-sm font-semibold uppercase sm:my-1 sm:py-2 sm:px-4 rounded-md",children:"Sort By"}),e(_,{data:H,onSelected:l})]}),le=()=>{const[l,d]=s.exports.useState([]),[t,i]=s.exports.useState(),[n,a]=s.exports.useState(1),[x,c]=s.exports.useState(!1),[r,h]=s.exports.useState(!1),[u,v]=s.exports.useState(!1),[b,f]=s.exports.useState([]),[g,y]=s.exports.useState([0,1e4]),[p,M]=s.exports.useState("latest-arrival"),[R,W]=s.exports.useState([]),[k,X]=s.exports.useState(""),j=async()=>{x||h(!0);try{const{data:m}=await C.get(`/api/v1/shop?page=${n}&q=${k}&brand=${R}&category=${b}&price[0]=${g[0]}&price[1]=${g[1]}&sort=${p}&paginate=${q}`);d(x?S=>[...S,...m.response.data]:m.response.data),i(m.response.meta)}catch(m){const S=m.response.data.message;console.log(S)}finally{c(!1),h(!1),v(!1)}},$=m=>{f([...m]),a(1)},A=m=>{y([...m]),a(1)},B=()=>{Number(t==null?void 0:t.page)<Number(t==null?void 0:t.totalPages)&&(a(m=>m+1),c(!0),v(!0))},E=m=>{M(m),a(1)};return s.exports.useEffect(()=>{j()},[b,g,p,n]),e("div",{className:"container mx-auto mt-4",children:o("div",{className:"grid grid-cols-1 md:grid-cols-4",children:[o("div",{className:"p-4 order-2 md:order-1 flex flex-col h-min",children:[o("div",{className:"flex justify-start text-sm",children:[e(P,{to:"/",children:"Home"}),e("p",{className:"mx-2",children:"/"}),e("p",{className:"text-gray-600",children:"Shop"})]}),e(z,{handleSelectedCategories:$}),e(G,{initalMin:0,initalMax:1e4,min:0,max:3e4,step:100,priceCap:200,handlePriceRange:A}),e(Q,{onSelectedRadio:E})]}),o("div",{className:"p-4 col-span-3 order-1 md:order-2 h-auto",children:[e("div",{className:"flex justify-start",children:o("p",{className:"text-sm",children:["Showing ",t==null?void 0:t.page,"-",t==null?void 0:t.totalPages," of ",t==null?void 0:t.total," results"]})}),r?"Loading...":o(T,{children:[e(K,{products:D(l)}),e("div",{className:"flex justify-center pt-8",children:n!==(t==null?void 0:t.totalPages)&&e(F,{className:"content-between bg-transparent hover:bg-[#212529] text-[#212529] font-semibold hover:text-white py-2 px-4 border border-[#212529] hover:border-transparent rounded disabled:bg-[#999FA4] disabled:text-[#F5F5F5] disabled:border-[#999FA4] disabled:cursor-not-allowed",btnText:u?"Loading...":"Load More",isDisabled:u,onClick:B})})]})]})]})})};export{le as Shop,le as default};
